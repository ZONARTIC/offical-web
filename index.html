<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zonartic Games - Mobile Game Publisher</title>
  <meta name="description" content="Discover amazing mobile games from Zonartic Games">
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <!-- HEADER -->
  <header>
    <div class="header-container">
      <div class="logo" onclick="window.location.href='index.html'">
        <img src="images/logo.png" alt="Zonartic Logo" />
      </div>
      
      <button class="menu-toggle" onclick="toggleMenu(event)" aria-label="Toggle menu" aria-expanded="false">‚ò∞</button>
      
      <div class="nav-wrapper">
        <nav class="nav-menu">
          <ul>
            <li><a href="index.html" class="active">HOME</a></li>
            <li><a href="blog.html">BLOG</a></li>
            <li><a href="mobile-games.html">MOBILE GAMES</a></li>
            <li><a href="test-games.html">TEST GAMES</a></li>
            <li><a href="about.html">ABOUT US</a></li>
            <li><a href="contact.html">CONTACT US</a></li>
          </ul>
          <div class="social-icons">
            <a href="https://www.facebook.com/profile.php?id=61584723680310" target="_blank" rel="noopener noreferrer">
              <img src="images/facebook.png" alt="Facebook" />
            </a>
            <a href="https://www.instagram.com/zonartic_studio?igsh=NXpvcDB6cHA1eWFw" target="_blank" rel="noopener noreferrer">
              <img src="images/instagram.png" alt="Instagram" />
            </a>
            <a href="https://x.com/Zonartic_Studio" target="_blank" rel="noopener noreferrer">
              <img src="images/twitter.png" alt="Twitter" />
            </a>
            <a href="https://youtube.com" target="_blank" rel="noopener noreferrer">
              <img src="images/youtube.png" alt="YouTube" />
            </a>
          </div>
        </nav>
      </div>
    </div>
  </header>
  
  <!-- MAIN CONTENT -->
  <main>
    <section class="explore">
      <h2>Explore New Games</h2>
      
      <!-- Search Bar -->
      <div class="search-container">
        <div class="search-wrapper">
          <input 
            type="text" 
            id="game-search" 
            class="search-input" 
            placeholder="Search for games..."
            autocomplete="off"
          />
          <button class="search-button" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
              <path d="M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM19 19l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
        <div id="search-results" class="search-results hidden"></div>
      </div>
      
      <!-- GOOGLE GROUP PANEL WITH EMAIL INVITATION -->
      <div class="group-panel">
        <div class="group-panel-content">
          <h3>
            <span class="group-icon">üë•</span>
            Tham Gia Nh√≥m Test Game
          </h3>
          <p>Tr·ªü th√†nh ng∆∞·ªùi ƒë·∫ßu ti√™n tr·∫£i nghi·ªám c√°c game m·ªõi! Nh·∫≠p email v√† ch√∫ng t√¥i s·∫Ω g·ª≠i l·ªùi m·ªùi tham gia nh√≥m cho b·∫°n.</p>
          
          <div class="group-notice">
            <strong>‚ö†Ô∏è L∆ØU √ù H∆Ø·ªöNG D·∫™N THAM GIA:</strong>
            <ul>
              <li>#Ch·ªâ ƒëƒÉng k√Ω m·ªôt l·∫ßn duy nh·∫•t ƒë·ªÉ t·∫£i t·∫•t c·∫£ c√°c game</li>
              <li>B∆∞·ªõc 1: Ki·ªÉm tra Email ƒëƒÉng k√Ω = Email CH play </li>
              <li>B∆∞·ªõc 2: Ki·ªÉm tra Email ƒëƒÉng k√Ω = Email hi·ªán c√≥ trong tr√¨nh duy·ªát </li>
              <li>B∆∞·ªõc 3: Nh·∫≠p Email ƒë√£ ch·ªçn v√†o khung ƒëƒÉng k√Ω</li>
              <li>B∆∞·ªõc 4: Ki·ªÉm tra th∆∞ trong Gmail v√† nh·∫•n x√°c nh·∫≠n tham gia.</li>
              <li>B∆∞·ªõc 5: Vui l√≤ng l√†m theo h∆∞·ªõng d·∫´n c·ªßa Google v√† ƒë·ª£i x·ª≠ l√Ω th√¥ng tin trong v√†i ph√∫t.</li>
            </ul>
          </div>
          
          <div class="group-form">
            <div class="form-group">
              <label for="user-email">Email c·ªßa b·∫°n (Gmail) *</label>
              <input 
                type="email" 
                id="user-email" 
                placeholder="example@gmail.com" 
                required
              />
            </div>
            
            <div class="form-group">
              <label for="user-name">T√™n c·ªßa b·∫°n (kh√¥ng b·∫Øt bu·ªôc)</label>
              <input 
                type="text" 
                id="user-name" 
                placeholder="T√™n c·ªßa b·∫°n" 
              />
            </div>
            
            <button class="join-button" id="joinButton" onclick="joinGroupWithAPI()">
              üìß G·ª≠i Y√™u C·∫ßu Tham Gia
            </button>
            
            <div id="success-message" class="success-message"></div>
            <div id="error-message" class="error-message"></div>
            
          </div>
        </div>
      </div>
      
       <!-- Download Games Section Title -->
<div class="download-games-title">
  <div class="title-line"></div>
  <h3>T·∫¢I GAME B√äN D∆Ø·ªöI</h3>
  <div class="title-line"></div>
</div>
      
      <!-- Games Container -->
      <div id="games-container">
        <div class="game-card">
          <div class="game-icon">
            <img src="images/game-icon.png" alt="Game Icon" />
          </div>
          <div class="game-info">
            <h3>Game Title</h3>
            <p>Game description will appear here. Add games in games.json file.</p>
            <div class="download-buttons">
              <a href="#" onclick="alert('Add game link in games.json'); return false;">
                GET IT ON Google Play
              </a>
            </div>
          </div>
          <div class="game-promo">
            <img src="images/game-promo.jpg" alt="Game Promo" />
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <!-- FOOTER -->
  <footer>
    <p>&copy; 2025 Zonartic Games. All rights reserved.</p>
    <div class="footer-links">
      <a href="terms.html">ƒêi·ªÅu Kho·∫£n S·ª≠ D·ª•ng</a>
      <span>|</span>
      <a href="privacy.html">Ch√≠nh S√°ch B·∫£o M·∫≠t</a>
    </div>
  </div>
  </footer>
  <!-- Scroll Down Arrow -->
  <div class="scroll-arrow" onclick="document.getElementById('games-container').scrollIntoView({behavior: 'smooth'})">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 5v14M19 12l-7 7-7-7"/>
    </svg>
  </div>
  
  <!-- Floating Contact Button -->
  <a href="contact.html" class="floating-contact" aria-label="Contact Us">
  
  <!-- Floating Contact Button -->
  <a href="contact.html" class="floating-contact" aria-label="Contact Us">
    <img src="images/contact-icon.png" alt="Contact" />
  </a>
  
  <!-- JavaScript -->
 <script>
    // ==========================================
    // PROTECTED API CONFIGURATION
    // ==========================================
    function getAPI() {
      const parts = [
        'paste here',
        'paste here',
        'paste here',
        'paste here',
        'paste here',
        'paste here'
      ];
      let url = '';
      for (let i = 0; i < parts.length; i++) {
        url += atob(parts[i]);
      }
      return url;
    }
    const API_ENDPOINT = getAPI();
    
    // ==========================================
    // Mobile Menu Toggle
    // ==========================================
    function toggleMenu(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      
      setTimeout(function() {
        const navWrapper = document.querySelector('.nav-wrapper');
        const menuToggle = document.querySelector('.menu-toggle');
        
        if (!navWrapper || !menuToggle) return;
        
        navWrapper.classList.toggle('show');
        
        if (navWrapper.classList.contains('show')) {
          menuToggle.innerHTML = '‚úï';
          menuToggle.setAttribute('aria-expanded', 'true');
        } else {
          menuToggle.innerHTML = '‚ò∞';
          menuToggle.setAttribute('aria-expanded', 'false');
        }
      }, 50);
    }
    
    document.addEventListener('click', function(event) {
      if (window.innerWidth <= 768) {
        setTimeout(function() {
          const navWrapper = document.querySelector('.nav-wrapper');
          const menuToggle = document.querySelector('.menu-toggle');
          const header = document.querySelector('header');
          
          if (!navWrapper || !menuToggle || !header) return;
          
          if (!header.contains(event.target) && navWrapper.classList.contains('show')) {
            navWrapper.classList.remove('show');
            menuToggle.innerHTML = '‚ò∞';
            menuToggle.setAttribute('aria-expanded', 'false');
          }
        }, 50);
      }
    });
    
    document.addEventListener('DOMContentLoaded', function() {
      document.body.addEventListener('click', function(event) {
        if (window.innerWidth <= 768) {
          const target = event.target.closest('.nav-menu a');
          
          if (target) {
            setTimeout(function() {
              const navWrapper = document.querySelector('.nav-wrapper');
              const menuToggle = document.querySelector('.menu-toggle');
              
              if (!navWrapper || !menuToggle) return;
              
              navWrapper.classList.remove('show');
              menuToggle.innerHTML = '‚ò∞';
              menuToggle.setAttribute('aria-expanded', 'false');
            }, 100);
          }
        }
      });
    });
    
    let resizeTimer;
    window.addEventListener('resize', function() {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(function() {
        const navWrapper = document.querySelector('.nav-wrapper');
        const menuToggle = document.querySelector('.menu-toggle');
        
        if (!navWrapper || !menuToggle) return;
        
        if (window.innerWidth > 768) {
          navWrapper.classList.remove('show');
          menuToggle.innerHTML = '‚ò∞';
          menuToggle.setAttribute('aria-expanded', 'false');
        }
      }, 100);
    });
    
    if (typeof MutationObserver !== 'undefined') {
      const observer = new MutationObserver(function(mutations) {
        const menuToggle = document.querySelector('.menu-toggle');
        if (menuToggle && !menuToggle.hasAttribute('data-listener-attached')) {
          menuToggle.setAttribute('data-listener-attached', 'true');
        }
      });
      
      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
    }
    
    // ==========================================
    // SEND GROUP INVITATION VIA EMAIL
    // ==========================================
    async function joinGroupWithAPI() {
      const emailInput = document.getElementById('user-email');
      const nameInput = document.getElementById('user-name');
      const joinButton = document.getElementById('joinButton');
      const successMessage = document.getElementById('success-message');
      const errorMessage = document.getElementById('error-message');
      
      const email = emailInput.value.trim();
      const name = nameInput.value.trim() || 'Guest';
      
      // Hide previous messages
      successMessage.classList.remove('show');
      errorMessage.classList.remove('show');
      successMessage.textContent = '';
      errorMessage.textContent = '';
      
      // Validate email
      if (!email) {
        showError('‚ö†Ô∏è Vui l√≤ng nh·∫≠p email c·ªßa b·∫°n!');
        emailInput.focus();
        return;
      }
      
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        showError('‚ö†Ô∏è Email kh√¥ng h·ª£p l·ªá! Vui l√≤ng nh·∫≠p ƒë√∫ng ƒë·ªãnh d·∫°ng.');
        emailInput.focus();
        return;
      }
      
      // Check if Gmail (warning only)
      if (!email.toLowerCase().endsWith('@gmail.com')) {
        const confirmNonGmail = confirm(
          '‚ö†Ô∏è Khuy·∫øn ngh·ªã s·ª≠ d·ª•ng Gmail ƒë·ªÉ d·ªÖ join group v√† test game.\n\n' +
          'Email kh√¥ng ph·∫£i Gmail. B·∫°n c√≥ mu·ªën ti·∫øp t·ª•c?'
        );
        if (!confirmNonGmail) return;
      }
      
      // Show loading
      joinButton.disabled = true;
      joinButton.textContent = '‚è≥ ƒêang g·ª≠i email...';
      
      try {
        console.log('Sending invitation to:', email);
        
        const response = await fetch(API_ENDPOINT, {
          method: 'POST',
          headers: {
            'Content-Type': 'text/plain',
          },
          body: JSON.stringify({
            email: email,
            name: name
          })
        });
        
        const result = await response.json();
        console.log('API Response:', result);
        
        if (result.success) {
          // Mask email for display (show first 3 chars + *** + domain)
          const maskedEmail = maskEmail(email);
          
          showSuccess(
            `‚úÖ ƒê√£ g·ª≠i y√™u c·∫ßu tham gia th√†nh c√¥ng!\n\n` +
            `üìß Email m·ªùi ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒë·∫øn: ${maskedEmail}\n\n` +
            `Vui l√≤ng ki·ªÉm tra h·ªôp th∆∞ v√† l√†m theo h∆∞·ªõng d·∫´n ƒë·ªÉ ho√†n t·∫•t vi·ªác tham gia nh√≥m.`
          );
          
          // Clear form
          emailInput.value = '';
          nameInput.value = '';
          
        } else {
          showError(`‚ùå L·ªói: ${result.message || 'Kh√¥ng th·ªÉ g·ª≠i email'}`);
        }
        
      } catch (error) {
        console.error('Error:', error);
        showError(
          'H·ªá th·ªëng ƒëang load l·∫°i, vui l√≤ng th·ª≠ l·∫°i sau v√†i gi√¢y.\n\n' +
          'Vui l√≤ng ki·ªÉm tra:\n' +
          '1. URL API ƒë√∫ng ch∆∞a\n' +
          '2. Google Apps Script ƒë√£ deploy ch∆∞a\n' +
          '3. Th·ª≠ l·∫°i sau v√†i ph√∫t'
        );
      } finally {
        joinButton.disabled = false;
        joinButton.textContent = 'üìß G·ª≠i Y√™u C·∫ßu Tham Gia';
      }
    }
    
    // ==========================================
    // HELPER FUNCTIONS
    // ==========================================
    function maskEmail(email) {
      const [localPart, domain] = email.split('@');
      if (localPart.length <= 3) {
        return localPart.charAt(0) + '***@' + domain;
      }
      return localPart.substring(0, 3) + '***@' + domain;
    }
    
    function showSuccess(message) {
      const successMessage = document.getElementById('success-message');
      successMessage.textContent = message;
      successMessage.classList.add('show');
      
      // Scroll to message
      successMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      
      // Hide after 15 seconds
      setTimeout(() => {
        successMessage.classList.remove('show');
      }, 15000);
    }
    
    function showError(message) {
      const errorMessage = document.getElementById('error-message');
      errorMessage.textContent = message;
      errorMessage.classList.add('show');
      
      // Scroll to message
      errorMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      
      // Hide after 10 seconds
      setTimeout(() => {
        errorMessage.classList.remove('show');
      }, 10000);
    }
    
    // Enter key to submit
    document.getElementById('user-email').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        joinGroupWithAPI();
      }
    });
    
    document.getElementById('user-name').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        e.preventDefault();
        joinGroupWithAPI();
      }
    });
    // ==========================================
    // SCROLL ARROW VISIBILITY - TH√äM V√ÄO ƒê√ÇY
    // ==========================================
    window.addEventListener('scroll', function() {
      const scrollArrow = document.querySelector('.scroll-arrow');
      const footer = document.querySelector('footer');
      
      if (!scrollArrow || !footer) return;
      
      const footerTop = footer.getBoundingClientRect().top;
      const windowHeight = window.innerHeight;
      
      // ·∫®n m≈©i t√™n khi footer xu·∫•t hi·ªán tr√™n m√†n h√¨nh
      if (footerTop <= windowHeight) {
        scrollArrow.classList.add('hidden');
      } else {
        scrollArrow.classList.remove('hidden');
      }
    });
    
    // ==========================================
    // LOAD GAMES FROM JSON - V·ªöI LOAD MORE
    // ==========================================
    let gamesData = [];
    let currentPage = 1;
    const gamesPerPage = 10; // S·ªë games hi·ªÉn th·ªã m·ªói l·∫ßn

    async function loadGames() {
      try {
        const response = await fetch('data/games.json');
        const allGames = await response.json();
        
        // L·ªçc games ƒë√£ published v√† l√† test games
        gamesData = allGames.filter(game =>  game.isTest);
        
        // Reset v·ªÅ trang 1
        currentPage = 1;
        renderGames();
      } catch (error) {
        console.log('Could not load games:', error);
      }
    }

    function renderGames() {
      const container = document.getElementById('games-container');
      if (!container) return;
      
      if (gamesData.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:#666;padding:40px;">Ch∆∞a c√≥ game n√†o.</p>';
        return;
      }
      
      // L·∫•y s·ªë games c·∫ßn hi·ªÉn th·ªã
      const gamesToShow = gamesData.slice(0, currentPage * gamesPerPage);
      
      // Render game cards
      let html = gamesToShow.map(game => `
        <div class="game-card" id="${game.id}">
          <div class="game-icon">
            <img src="${game.icon}" alt="${game.name} Icon" loading="lazy" />
          </div>
          <div class="game-info">
            <h3>${game.name}</h3>
            <p>${game.description}</p>
            <div class="download-buttons">
              <a href="${game.testLink}" target="_blank" rel="noopener noreferrer">
                GET IT ON Google Play
              </a>
            </div>
          </div>
          <div class="game-promo">
            <img src="${game.promo}" alt="${game.name} Promo" loading="lazy" />
          </div>
        </div>
      `).join('');
      
      // Th√™m n√∫t Load More n·∫øu c√≤n games ch∆∞a hi·ªÉn th·ªã
      if (gamesToShow.length < gamesData.length) {
        const remaining = gamesData.length - gamesToShow.length;
        html += `
          <div class="load-more-container">
            <button class="load-more-btn" onclick="loadMoreGames()">
              üì± Xem th√™m ${Math.min(gamesPerPage, remaining)} games n·ªØa
            </button>
            <p class="games-count">ƒêang hi·ªÉn th·ªã ${gamesToShow.length} / ${gamesData.length} games</p>
          </div>
        `;
      }
      
      container.innerHTML = html;
    }

    function loadMoreGames() {
      currentPage++;
      renderGames();
      
      // Scroll xu·ªëng m·ªôt ch√∫t ƒë·ªÉ th·∫•y games m·ªõi
      setTimeout(() => {
        window.scrollBy({ top: 200, behavior: 'smooth' });
      }, 100);
    }

    // ==========================================
    // GAME SEARCH FUNCTIONALITY
    // ==========================================
    const searchInput = document.getElementById('game-search');
    const searchResults = document.getElementById('search-results');
    
    if (searchInput && searchResults) {
      searchInput.addEventListener('input', function(e) {
        const query = e.target.value.trim().toLowerCase();
        
        if (query.length < 2) {
          searchResults.classList.add('hidden');
          searchResults.innerHTML = '';
          return;
        }
        
        if (gamesData.length === 0) {
          searchResults.innerHTML = '<div class="search-no-results">Ch∆∞a c√≥ game n√†o.</div>';
          searchResults.classList.remove('hidden');
          return;
        }
        
        const filtered = gamesData.filter(game => 
          game.name.toLowerCase().includes(query) ||
          game.description.toLowerCase().includes(query) ||
          game.category.toLowerCase().includes(query)
        );
        
        if (filtered.length > 0) {
          searchResults.innerHTML = filtered.map(game => `
            <a href="${game.testLink}" class="search-result-item" target="_blank">
              <img src="${game.icon}" alt="${game.name}" class="search-result-icon" />
              <div class="search-result-info">
                <div class="search-result-name">${game.name}</div>
                <div class="search-result-category">${game.category}</div>
              </div>
            </a>
          `).join('');
          searchResults.classList.remove('hidden');
        } else {
          searchResults.innerHTML = '<div class="search-no-results">Kh√¥ng t√¨m th·∫•y game</div>';
          searchResults.classList.remove('hidden');
        }
      });
      
      document.addEventListener('click', function(e) {
        if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
          searchResults.classList.add('hidden');
        }
      });
      
      searchInput.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          searchInput.value = '';
          searchResults.classList.add('hidden');
        }
      });
    }
    
    // Load games khi trang load xong
    document.addEventListener('DOMContentLoaded', loadGames);
  </script>

</body>
</html>
